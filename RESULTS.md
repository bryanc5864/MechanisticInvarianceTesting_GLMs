# MIT Benchmark Results

> All results generated by `scripts/run_all_experiments.py` with full logging.
> Experiment logs are stored in `logs/` with timestamps.

## Overview

This benchmark evaluates whether genomic language models (gLMs) encode the mechanistic logic of regulatory compensation in E. coli σ70 promoters. The primary metric is the **Compensation Sensitivity Score (CSS)**, which measures how often a model scores compensated sequences higher than broken sequences.

- **CSS > 0.5**: Model recognizes compensation
- **CSS = 0.5**: Model cannot distinguish (random baseline)
- **CSS < 0.5**: Model penalizes compensated sequences

## Model Comparison

| Model | CSS | 95% CI | p-value (raw) | p-value (FDR) | Significant |
|-------|-----|--------|---------------|---------------|-------------|
| HyenaDNA | **0.630** | [0.530, 0.730] | **0.0043** | **0.0344** | **Yes** |
| Evo2-1B | 0.600 | [0.500, 0.690] | 0.0225 | 0.0900 | No |
| NT-500M | 0.540 | [0.440, 0.640] | 0.2132 | 0.5685 | No |
| GROVER | 0.520 | [0.430, 0.620] | 0.3456 | 0.6912 | No |
| Random | 0.500 | [0.400, 0.600] | 0.5000 | 0.7716 | No |
| Caduceus | 0.490 | [0.400, 0.590] | 0.5787 | 0.7716 | No |
| k-mer | 0.430 | [0.340, 0.530] | 0.9187 | 1.0000 | No |
| PWM | 0.000 | [0.000, 0.000] | 1.0000 | 1.0000 | No |

> **Note**: p-values adjusted using Benjamini-Hochberg FDR correction across all 8 CSS tests. HyenaDNA remains significant at FDR < 0.05. Evo2-1B is significant at the uncorrected level (p=0.023) but not after FDR correction (p=0.090).

## Full Metrics (with Bootstrap 95% CIs)

| Model | CSS [CI] | MES Natural [CI] | MES Synthetic [CI] | SCR [CI] | SCR p-value |
|-------|----------|-------------------|---------------------|----------|-------------|
| HyenaDNA | 0.630 [0.53, 0.73] | -0.01 [-0.29, 0.27] | -0.34 [-0.62, -0.06] | 0.480 [0.34, 0.62] | 0.712 |
| Evo2-1B | 0.600 [0.50, 0.69] | 0.38 [0.11, 0.67] | -0.03 [-0.30, 0.25] | 0.460 [0.32, 0.60] | 0.712 |
| NT-500M | 0.540 [0.44, 0.64] | -0.00 [-0.28, 0.27] | -0.10 [-0.37, 0.16] | 0.400 [0.26, 0.56] | 0.920 |
| GROVER | 0.520 [0.43, 0.62] | -0.08 [-0.36, 0.20] | -0.05 [-0.33, 0.23] | 0.520 [0.38, 0.66] | 0.388 |
| Random | 0.500 [0.40, 0.60] | -0.14 [-0.42, 0.14] | -0.04 [-0.32, 0.24] | 0.460 [0.32, 0.60] | 0.612 |
| Caduceus | 0.490 [0.40, 0.59] | -0.17 [-0.46, 0.12] | -0.40 [-0.68, -0.12] | 0.420 [0.28, 0.56] | 0.869 |
| k-mer | 0.430 [0.34, 0.53] | -0.17 [-0.45, 0.11] | 0.11 [-0.17, 0.39] | 0.500 [0.36, 0.64] | 0.500 |
| PWM | 0.000 [0.00, 0.00] | 0.70 [0.42, 0.98] | 10.00 [10.00, 10.00] | 0.000 [0.00, 0.00] | 1.000 |

> All confidence intervals computed via bootstrap resampling (n=1000). Effect sizes reported as Cohen's d.

### Metric Definitions

- **CSS (Compensation Sensitivity Score)**: Fraction of cases where LL(compensated) > LL(broken)
- **MES (Motif Effect Size)**: Cohen's d for intact vs broken sequences
- **CIR (Context Independence Ratio)**: MES_synthetic / MES_natural
- **CM (Compensation Magnitude)**: Fraction of likelihood recovery from compensation
- **SCR (Scramble Control Ratio)**: Fraction where structured > scrambled compensation

## Statistical Tests

| Test | p-value (raw) | p-value (FDR) | Significant (FDR < 0.05) |
|------|---------------|---------------|--------------------------|
| HyenaDNA CSS vs 0.5 | 0.0043 | 0.0344 | Yes |
| Evo2-1B CSS vs 0.5 | 0.0225 | 0.0900 | No |
| NT-500M CSS vs 0.5 | 0.2132 | 0.5685 | No |
| GROVER CSS vs 0.5 | 0.3456 | 0.6912 | No |
| Random CSS vs 0.5 | 0.5000 | 0.7716 | No |
| Caduceus CSS vs 0.5 | 0.5787 | 0.7716 | No |
| k-mer CSS vs 0.5 | 0.9187 | 1.0000 | No |
| PWM CSS vs 0.5 | 1.0000 | 1.0000 | No |
| HyenaDNA SCR vs 0.5 | 0.7120 | 0.7120 | No |
| Evo2-1B SCR vs 0.5 | 0.7120 | 0.7120 | No |
| NT-500M SCR vs 0.5 | 0.9203 | 0.9203 | No |
| Caduceus SCR vs 0.5 | 0.8690 | 0.8690 | No |

> Benjamini-Hochberg FDR correction applied across all tests.

## Key Findings

1. **HyenaDNA is the only tested model showing statistically significant compensation sensitivity** (CSS=0.630, FDR-corrected p=0.034), but extended experiments reveal this signal is driven by AT content correlation rather than mechanistic understanding.

2. **Evo2-1B shows suggestive but non-significant compensation sensitivity**: CSS=0.600 (raw p=0.023, FDR-corrected p=0.090). Notably, Evo2-1B is the only gLM with a **positive natural MES** (0.38, CI [0.11, 0.67]), meaning it correctly scores natural intact promoters higher than broken ones. However, its synthetic MES is near zero (-0.03) and SCR=0.460, indicating no structure sensitivity.

3. **Caduceus shows no compensation sensitivity**: CSS=0.490 (FDR-corrected p=0.772), essentially at chance. It has the most negative synthetic MES (-0.40, CI [-0.68, -0.12]) of any gLM, strongly scoring intact sequences lower than broken ones.

4. **No tested model shows significant structure sensitivity**: SCR is indistinguishable from 0.5 for all models (FDR-corrected p > 0.05), indicating models respond similarly to structured and scrambled compensatory elements.

5. **NT-500M shows no significant compensation sensitivity**: CSS=0.540 (FDR-corrected p=0.569), with SCR=0.400 indicating no structure sensitivity. NT-500M also shows near-zero MES (-0.00 natural, -0.10 synthetic), consistent with indifference to motif identity.

6. **Negative MES across most models**: Most gLMs tested score intact sequences (TATAAT) *lower* than broken (TGTAAT), suggesting they have learned genome-wide frequency priors that contradict functional importance (see [Negative MES Investigation](#negative-mes-investigation)). The exception is Evo2-1B, which correctly ranks intact > broken for natural sequences.

5. **PWM baseline achieves CSS=0.000** because it evaluates only the -35 and -10 boxes, giving identical scores to broken and compensated sequences (both have the same broken -10).

## Sequence Classes

| Class | Name | N | Description |
|-------|------|---|-------------|
| A | Natural Intact | 100 | Real promoters with strong -10 box |
| B | Natural Broken | 100 | Real promoters with mutated -10, no compensation |
| C | Synthetic Intact | 100 | Consensus -35 (TTGACA) and -10 (TATAAT) |
| D | Synthetic Broken | 100 | Consensus -35, broken -10 (TGTAAT) |
| E | Synthetic Compensated | 100 | Broken -10 + UP element + extended -10 |
| F | Over-Compensated | 50 | Broken -10 + all compensatory elements |
| G | Natural Compensated | 50 | Real promoters with compensation |
| H | Scrambled Control | 50 | Same composition as E, scrambled motifs |

**Total: 650 sequences**

## Figures

### CSS Comparison
![CSS Comparison](figures/css_comparison.png)

### Metrics Heatmap
![Metrics Heatmap](figures/metrics_heatmap.png)

### CSS vs MES
![CSS vs MES](figures/css_vs_mes.png)

## Deep Analysis: What Are gLMs Actually Learning?

### The Composition Effect

Analysis reveals that gLM CSS signals are primarily driven by **nucleotide composition**, not positional motif logic:

| Model | AT-LL Correlation | UP-region AT (Broken) | UP-region AT (Compensated) |
|-------|-------------------|-----------------------|----------------------------|
| HyenaDNA | **r = 0.784** | 57.8% | 82.1% |
| Caduceus | **r = 0.874** | 57.8% | 82.1% |
| Evo2-1B | **r = 0.961** | 57.8% | 82.1% |

The strong correlations between log-likelihood and AT content explain why models prefer compensated sequences: they contain AT-rich UP elements. All three architectures — autoregressive (HyenaDNA, Evo2-1B) and bidirectional SSM (Caduceus) — show the same compositional bias.

### Positional Ablation Test

To distinguish compositional from positional effects, we created sequences with UP elements at varying positions:

| Model | UP at 15 (correct) | UP at 70 (wrong) | No UP | Compositional vs Positional |
|-------|--------------------|-------------------|-------|---------------------------|
| HyenaDNA | -139.83 | -140.29 | -143.53 | 3.70 vs 0.46 (8x) |
| Evo2-1B | -137.12 | -136.57 | -138.58 | 1.46 vs -0.55 (wrong dir) |
| Caduceus | -146.73 | -145.98 | -147.98 | 1.25 vs -0.75 (wrong dir) |

**Key finding**: For all models, UP element presence matters more than position. Evo2-1B and Caduceus actually score UP at position 70 *higher* than at the correct position 15, confirming they have no positional awareness — only a composition-driven preference.

### The Scramble Control Problem

SCR ≈ 0.5 for all models indicates they respond **identically** to structured and scrambled compensation:

| Model | SCR | p-value | Interpretation |
|-------|-----|---------|----------------|
| HyenaDNA | 0.480 | 0.712 | Strand-blind |
| Evo2-1B | 0.460 | 0.712 | Strand-blind |
| Caduceus | 0.420 | 0.869 | Strand-blind |

### Negative MES Investigation

Counter-intuitively, all tested gLMs score synthetic **intact** sequences (TATAAT) **lower** than broken (TGTAAT). We investigated this by computing expected hexamer frequencies under E. coli genome composition:

| Hexamer | Expected Frequency | Ratio vs TATAAT |
|---------|-------------------|-----------------|
| TATAAT (intact) | 2.216e-4 | 1.000x |
| TGTAAT (broken) | 2.288e-4 | 1.033x |

Under the independence assumption with E. coli nucleotide frequencies (G: 25.4% vs A: 24.6%), TGTAAT is 1.033x more frequent than TATAAT. All 12 G/C-containing variants of TATAAT have higher expected frequency than the consensus, because G/C are slightly more common than A/T in E. coli.

**Biophysical models correctly rank intact > broken** (with position-aligned scoring):
- PA-PWM: TATAAT score = 18.69, TGTAAT score = 14.16 (intact correctly higher)
- Thermo: TATAAT score = 26.42, TGTAAT score = 20.64 (intact correctly higher)

Moreover, biophysical model scores are *negatively* correlated with hexamer frequency (PA-PWM: r=-0.827, Thermo: r=-0.762), meaning they correctly assign highest scores to the functional consensus despite it being slightly less frequent in the genome.

**Key insight**: Biophysical models rank intact > broken because they encode *functional importance*, not *statistical frequency*. gLMs have learned frequency priors that contradict biological function at this critical regulatory position.

See `scripts/experiment_negative_mes.py` for full analysis of all 18 single-nucleotide -10 variants.

## Interpretation

HyenaDNA exhibits statistically significant compensation sensitivity (CSS=0.630, FDR-corrected p=0.034), and Evo2-1B shows a suggestive trend (CSS=0.600, raw p=0.023, FDR p=0.090). Extended experiments on all three models (HyenaDNA, Evo2-1B, Caduceus) confirm these signals are driven by a learned heuristic: **"AT-rich upstream sequences correlate with functional promoters."**

This is technically correct -- UP elements are AT-rich and do enhance transcription (Estrem et al. 1998; Ross et al. 1993). However, all tested models fail to encode the **positional logic** that makes this work biologically:

1. UP elements must be at specific positions relative to -35 — all models peak at wrong positions
2. The extended -10 (TGT) must be immediately upstream of -10 — no model shows spacing awareness
3. Scrambling these elements should destroy function — SCR ≈ 0.5 for all models
4. Promoter elements are strand-specific — all models are strand-blind

The AT-LL correlation is strong across all models: r=0.784 (HyenaDNA), r=0.961 (Evo2-1B). Evo2-1B's even stronger AT dependence is consistent with its autoregressive architecture capturing genome-wide base composition patterns.

### Conclusion

> The tested gLMs — spanning autoregressive (HyenaDNA, Evo2-1B), masked language model (NT-500M, GROVER), and bidirectional SSM (Caduceus) architectures — capture **statistical associations** between sequence features and regulatory function, but fail to encode the **positional logic** that underlies mechanistic compensation in bacterial transcription. Evo2-1B is notable for correctly ranking natural intact > broken sequences (positive MES), but this does not extend to mechanistic compensation sensitivity. These results apply to the models and regulatory system tested here; additional regulatory contexts should be evaluated to assess generality.

---

## Extended Experiments

All extended experiments were run on HyenaDNA, Evo2-1B, and Caduceus. Scripts accept `--model` flag (e.g., `python scripts/experiment_at_titration.py --model evo2_1b`).

### Experiment 2.1: AT Titration

**Question**: Does LL correlate with background AT content, independent of motifs?

#### HyenaDNA

| AT% | Intact LL | Broken LL | Compensated LL |
|-----|-----------|-----------|----------------|
| 30% | -144.3 | -142.1 | -142.6 |
| 40% | -147.0 | -145.6 | -143.5 |
| 50% | -145.6 | -144.6 | -140.8 |
| 60% | -140.1 | -140.0 | -136.3 |
| 70% | -131.4 | -131.7 | -130.2 |
| 80% | -122.9 | -124.2 | -123.6 |

**AT-LL Correlation: r = 0.784**

#### Evo2-1B

| AT% | Intact LL | Broken LL | Compensated LL |
|-----|-----------|-----------|----------------|
| 30% | -142.40 | -142.45 | -140.86 |
| 40% | -141.46 | -141.72 | -140.38 |
| 50% | -139.47 | -139.84 | -138.09 |
| 60% | -136.13 | -136.49 | -135.31 |
| 70% | -131.65 | -132.65 | -132.36 |
| 80% | -125.83 | -127.60 | -127.47 |

**AT-LL Correlation: r = 0.961** (even stronger than HyenaDNA)

#### Caduceus

| AT% | Intact LL | Broken LL | Compensated LL |
|-----|-----------|-----------|----------------|
| 30% | -148.50 | -146.43 | -149.89 |
| 40% | -153.24 | -151.01 | -152.02 |
| 50% | -151.94 | -149.39 | -148.77 |
| 60% | -145.16 | -144.07 | -142.43 |
| 70% | -137.82 | -137.08 | -136.77 |
| 80% | -124.48 | -125.53 | -128.33 |

**AT-LL Correlation: r = 0.874**

#### Cross-Model Comparison

| Model | AT-LL Correlation | LL Range (30%→80%) | Interpretation |
|-------|-------------------|--------------------|----------------|
| HyenaDNA | r = 0.784 | ~21 units | Strong AT bias |
| Caduceus | r = 0.874 | ~24 units | Strong AT bias |
| Evo2-1B | r = 0.961 | ~16 units | Very strong AT bias |

**Key Finding**: All three models show strong AT-LL correlations (r=0.784-0.961). The AT effect dominates; motif differences are small and inconsistent across all models. Evo2-1B shows the strongest correlation despite having the narrowest LL range, suggesting its autoregressive architecture is particularly sensitive to base composition.

---

### Experiment 3.1: Positional Sweep

**Question**: Do models care where the UP element is located?

#### HyenaDNA

| UP Position | Mean LL | vs Correct (15) |
|-------------|---------|-----------------|
| 0 | -139.34 | +0.49 |
| 5 | -139.62 | +0.21 |
| 10 | -139.86 | -0.03 |
| **15** | **-139.83** | **0.00** |
| 20 | -139.92 | -0.08 |
| 25 | -142.37 | -2.53 |
| 35 | -139.94 | -0.11 |
| 45 | -142.00 | -2.17 |
| 60 | -140.32 | -0.49 |
| 70 | -140.29 | -0.46 |
| 80 | -139.76 | +0.07 |
| None | -143.53 | -3.70 |

#### Evo2-1B

| UP Position | Mean LL | vs Correct (15) |
|-------------|---------|-----------------|
| 0 | -138.53 | -1.41 |
| 5 | -138.16 | -1.04 |
| 10 | -138.37 | -1.25 |
| **15** | **-137.12** | **0.00** |
| 20 | -137.15 | -0.03 |
| 25 | -136.79 | +0.33 |
| 35 | -137.91 | -0.79 |
| 45 | -136.94 | +0.18 |
| 60 | -136.86 | +0.26 |
| 70 | -136.57 | +0.56 |
| 80 | -136.65 | +0.47 |
| **90** | **-136.40** | **+0.72** |
| None | -138.58 | -1.46 |

#### Caduceus

| UP Position | Mean LL | vs Correct (15) |
|-------------|---------|-----------------|
| 0 | -146.65 | +0.08 |
| 5 | -147.20 | -0.47 |
| 10 | -147.68 | -0.95 |
| **15** | **-146.73** | **0.00** |
| 20 | -149.69 | -2.96 |
| 25 | -146.90 | -0.17 |
| 35 | -148.70 | -1.98 |
| 45 | -146.81 | -0.08 |
| 60 | -146.28 | +0.45 |
| 70 | -145.98 | +0.75 |
| **80** | **-145.95** | **+0.78** |
| 90 | -146.11 | +0.62 |
| None | -147.98 | -1.25 |

#### Cross-Model Comparison

| Model | Peak Position | Correct (15) | UP Effect (15 vs None) | Position Effect (15 vs 70) |
|-------|--------------|--------------|------------------------|----------------------------|
| HyenaDNA | 0 | -139.83 | +3.70 | +0.46 |
| Evo2-1B | 90 | -137.12 | +1.46 | -0.55 |
| Caduceus | 80 | -146.73 | +1.25 | -0.75 |

**Key Findings**:
1. No model peaks at the correct position (15). All peak at distant positions (0, 90, or 80).
2. All models show a UP element presence effect (vs None) — confirming AT-rich content helps.
3. All models show negligible or wrong-direction positional effects — UP at position 70-90 scores higher than or equal to position 15.
4. HyenaDNA's compositional effect (3.70) is 8x its positional effect (0.46). Evo2-1B and Caduceus show even less positional sensitivity.

---

### Experiment 3.2: Spacing Sensitivity

**Question**: Do models know the optimal 17bp spacing between -35 and -10?

#### HyenaDNA

| Spacing | Mean LL | vs Optimal (17bp) |
|---------|---------|-------------------|
| 12bp | -143.47 | -1.20 |
| 13bp | -142.71 | -0.44 |
| **14bp** | **-141.79** | **+0.48** |
| 15bp | -142.87 | -0.60 |
| 16bp | -142.66 | -0.40 |
| 17bp | -142.27 | 0.00 |
| 18bp | -142.19 | +0.08 |
| 19bp | -142.84 | -0.57 |
| 20bp | -143.12 | -0.85 |
| 22bp | -142.27 | +0.00 |
| 25bp | -143.10 | -0.83 |

#### Evo2-1B

| Spacing | Mean LL | vs Optimal (17bp) |
|---------|---------|-------------------|
| 12bp | -138.43 | -0.79 |
| 13bp | -138.32 | -0.68 |
| 14bp | -138.01 | -0.37 |
| **15bp** | **-137.40** | **+0.24** |
| 16bp | -137.98 | -0.34 |
| 17bp | -137.64 | 0.00 |
| 18bp | -138.34 | -0.70 |
| 19bp | -137.77 | -0.13 |
| 20bp | -137.80 | -0.16 |
| 21bp | -137.70 | -0.07 |
| 22bp | -137.58 | +0.06 |
| 23bp | -137.61 | +0.03 |
| 24bp | -138.24 | -0.60 |
| 25bp | -138.36 | -0.72 |

#### Caduceus

| Spacing | Mean LL | vs Optimal (17bp) |
|---------|---------|-------------------|
| 12bp | -149.24 | -0.70 |
| 13bp | -149.22 | -0.68 |
| 14bp | -149.24 | -0.70 |
| 15bp | -147.96 | +0.59 |
| 16bp | -150.32 | -1.77 |
| 17bp | -148.54 | 0.00 |
| 18bp | -150.38 | -1.84 |
| 19bp | -148.72 | -0.18 |
| **20bp** | **-147.15** | **+1.40** |
| 21bp | -149.00 | -0.46 |
| 22bp | -148.09 | +0.45 |
| 23bp | -148.53 | +0.01 |
| 24bp | -148.34 | +0.20 |
| 25bp | -149.36 | -0.81 |

#### Cross-Model Comparison

| Model | Peak Spacing | LL Range | Correct (17bp) |
|-------|-------------|----------|----------------|
| HyenaDNA | 14bp | 1.67 units | Not peak |
| Evo2-1B | 15bp | 1.03 units | Not peak |
| Caduceus | 20bp | 3.23 units | Not peak |

**Key Findings**:
1. No model peaks at the biologically optimal 17bp spacing.
2. HyenaDNA peaks at 14bp; Evo2-1B peaks at 15bp; Caduceus peaks at 20bp.
3. LL ranges are small relative to noise — essentially flat across all spacings.
4. None of the tested models encode the biologically optimal -35/-10 spacing.

---

### Experiment 3.3: Strand Orientation

**Question**: Do models know promoter elements are strand-specific?

#### HyenaDNA

| Condition | Mean LL | Description |
|-----------|---------|-------------|
| Forward | -143.79 | Correct orientation |
| RC-in-place | -142.83 | RC motifs, same position |
| Full RC | -142.13 | Full reverse complement |
| Scrambled | -143.98 | Scrambled motifs |

#### Evo2-1B

| Condition | Mean LL | Description |
|-----------|---------|-------------|
| Forward | -138.18 | Correct orientation |
| RC-in-place | -138.01 | RC motifs, same position |
| Full RC | -138.15 | Full reverse complement |
| Scrambled | -137.69 | Scrambled motifs |

#### Caduceus

| Condition | Mean LL | Description |
|-----------|---------|-------------|
| Forward | -149.13 | Correct orientation |
| RC-in-place | -149.31 | RC motifs, same position |
| Full RC | -149.12 | Full reverse complement |
| Scrambled | -148.66 | Scrambled motifs |

#### Cross-Model Comparison

| Model | Fwd vs RC-in-place | Fwd vs Scrambled | LL Range | Strand-Aware? |
|-------|--------------------|--------------------|----------|---------------|
| HyenaDNA | -0.95 | +0.19 | 1.85 | No |
| Evo2-1B | -0.17 | -0.48 | 0.49 | No |
| Caduceus | +0.18 | -0.46 | 0.65 | No |

**Key Findings**:
1. **All models are strand-blind.** No model scores forward orientation meaningfully higher than RC or scrambled.
2. HyenaDNA actually scores forward LOWER than RC-in-place (-0.95).
3. Both Evo2-1B and Caduceus score scrambled motifs HIGHER than forward (-0.48, -0.46).
4. LL ranges are tiny (0.49-1.85 units) — no statistically significant strand preference for any model.

---

## Summary of All Experiments

| Experiment | HyenaDNA | Evo2-1B | Caduceus | Implication |
|------------|----------|---------|----------|-------------|
| AT Titration | r=0.784 | r=0.961 | r=0.874 | Compositional, not motif-based |
| Positional Sweep | Peak at 0, UP 8x pos | Peak at 90, pos wrong dir | Peak at 80, pos wrong dir | No meaningful positional encoding |
| Spacing | Peak at 14bp | Peak at 15bp | Peak at 20bp | Does not encode optimal spacing |
| Strand | Fwd < RC (-0.95) | Fwd < Scrambled (-0.48) | Fwd < Scrambled (-0.46) | Strand-blind |
| Scramble Control | SCR=0.48 (p=0.71) | SCR=0.46 (p=0.71) | SCR=0.42 (p=0.87) | Cannot distinguish structure from composition |
| Negative MES | Intact < Broken | Intact > Broken (natural only) | Intact < Broken | Frequency priors contradict function |
| Error Analysis | AT% predicts success (p=1e-6) | AT% predicts success | AT% predicts success | Confirms AT-driven heuristic |

### Conclusion

The tested gLMs — including autoregressive (HyenaDNA, Evo2-1B), masked (NT-500M, GROVER), and bidirectional SSM (Caduceus) architectures — appear to have learned a simple heuristic: **"AT-rich sequences are more likely."**

This heuristic happens to correlate with promoter function (UP elements are AT-rich), producing apparent "compensation sensitivity" (HyenaDNA CSS=0.630, Evo2-1B CSS=0.600). However, all tested models fail every mechanistic test we applied:

1. **Position doesn't matter** — all models peak at wrong positions (0, 80, 90 instead of 15); compositional effect dominates
2. **Spacing doesn't matter** — peak spacings are 14-15bp, not the biological optimum of 17bp; LL ranges are essentially flat
3. **Strand doesn't matter** — all models are strand-blind; forward orientation scores equal to or lower than RC/scrambled
4. **Motif sequence doesn't matter** — SCR ≈ 0.5 for all models (p > 0.05)
5. **AT content dominates** — r=0.784 (HyenaDNA), r=0.961 (Evo2-1B)
6. **Error analysis confirms AT%-driven successes** — p=1e-6 for HyenaDNA

In contrast, biophysical models with explicit positional and compensation logic achieve CSS=1.000 and SCR=0.980. Even RPA-PWM, which uses only relative biological constraints without hardcoded positions, achieves CSS=1.000 and SCR=0.920. Ablation shows removing compensation logic produces CSS=0.000 (tied scores), and removing positional encoding produces CSS=0.630 — matching HyenaDNA exactly.

These results are consistent with **shallow statistical learning** rather than **mechanistic understanding** of promoter regulation.

---

## Biophysical Model Comparison

To demonstrate that the mechanistic tests are solvable, we implemented biophysical models with explicit positional encoding, plus ablation variants to address the concern that PA-PWM is "tuned to win."

### Models

1. **PA-PWM (Position-Aware PWM)**: Scores -35/-10 boxes at expected positions with spacing and compensation bonuses
2. **RPA-PWM (Relative Position-Aware PWM)**: Scans for motifs on both strands with NO position assumptions; enforces only relative biological constraints (spacing 17±2bp, UP upstream of -35, ext-10 adjacent to -10, strand consistency). Addresses the PA-PWM circularity critique.
3. **PA-PWM-NoComp (Ablation)**: Same as PA-PWM but without UP element or extended -10 scoring — tests whether compensation-specific logic is required
4. **PA-PWM-NoPos (Ablation)**: Scans for best motif matches anywhere with no positional constraints — tests whether positional encoding matters
5. **Thermo (Thermodynamic)**: Free energy-based binding model with positional constraints
6. **Scan (Position-Scanning)**: Finds best motifs, then penalizes deviation from expected positions

### Results (Benchmark Sequences)

| Model | Type | CSS | SCR | Notes |
|-------|------|-----|-----|-------|
| **PA-PWM** | Biophysical | **1.000** | **0.980** | Full positional + compensation |
| **RPA-PWM** | Biophysical | **1.000** | **0.920** | Relative constraints only (no hardcoded positions) |
| PA-PWM-NoComp | Ablation | 0.000† | 0.000† | No UP/ext-10 scoring |
| PA-PWM-NoPos | Ablation | 0.630 | 0.560 | No positional constraints |
| **Thermo** | Biophysical | **0.970** | **0.680** | Free energy model |
| HyenaDNA | gLM | 0.630 | 0.480 | AT-driven |
| Evo2-1B | gLM | 0.600 | 0.460 | Suggestive, positive natural MES |
| NT-500M | gLM | 0.540 | 0.400 | Not significant |
| GROVER | gLM | 0.520 | 0.520 | Near random |
| Random | Baseline | 0.500 | 0.460 | Random baseline |
| Caduceus | gLM | 0.490 | 0.420 | At chance |
| Scan | Biophysical | 0.430 | 0.540 | Weak position scanning |
| k-mer | Baseline | 0.430 | 0.500 | Composition baseline |

> †PA-PWM-NoComp gives CSS=0.000 because all 100 D/E pairs score identically (tied): the model reads only -35 and -10, which are the same in both broken and compensated sequences. This confirms compensation-specific logic is required.

### Extended Results (Position-Matched Comparison)

The biophysical comparison script generates its own sequences and tests additional capabilities:

| Model | CSS | SCR | Peak Pos | Spacing Peak | Strand (Fwd-Scr) | AT Corr |
|-------|-----|-----|----------|--------------|-------------------|---------|
| PA-PWM | 1.000 | 0.970 | 15 (correct) | 17bp | +large | ~0 |
| RPA-PWM | 1.000 | 0.920 | 5-20 (correct range) | 17bp | +5.66 | 0.979 |
| PA-PWM-NoComp | 0.000 | 0.000 | -- | 17bp | +large | ~0 |
| PA-PWM-NoPos | 0.660 | 0.510 | -- | 18bp | +large | ~0 |
| Thermo | 1.000 | 0.830 | -- | 17bp | +large | ~0 |
| HyenaDNA | 0.630 | 0.480 | 0 (wrong) | 14bp | -0.19 | 0.784 |
| Evo2-1B | 0.600 | 0.460 | 90 (wrong) | 15bp | -0.48 | 0.961 |
| Caduceus | 0.490 | 0.420 | 80 (wrong) | 20bp | -0.46 | 0.874 |
| Scan | 0.440 | 0.420 | -- | 17bp | +large | ~0 |

### RPA-PWM: Addressing the Circularity Critique

**Critique**: "PA-PWM hardcodes benchmark-specific positions (30-35, 53-58), so it succeeds by construction."

**RPA-PWM** addresses this by encoding ONLY relative biological constraints:
- Scans both strands for -35 and -10 motifs (no position assumptions)
- Requires -35/-10 spacing of 15-19bp (peaks at 17bp)
- UP element must be upstream of -35 (not at a fixed position)
- Extended -10 must be immediately upstream of -10
- Strand consistency bonus

**Results on benchmark sequences**: CSS=1.000, SCR=0.920 — demonstrating that relative biological grammar alone is sufficient to solve the MIT benchmark without any benchmark-specific position knowledge.

**Diagnostic results**:

| Test | RPA-PWM | gLMs (best) | Interpretation |
|------|---------|-------------|----------------|
| Spacing peak | 17bp (correct) | 14-20bp (wrong) | RPA-PWM encodes optimal spacing |
| Strand preference | Forward (correct) | 44-50% (chance) | RPA-PWM is strand-aware |
| UP positional ablation | Upstream helps, downstream doesn't | No positional effect | RPA-PWM enforces relative position |
| AT-LL correlation | r=0.979 | r=0.784-0.961 | Both are AT-sensitive (see caveat below) |

**AT sensitivity caveat**: RPA-PWM shows high AT correlation (r=0.979) because its UP element detector responds to AT-rich regions. However, unlike gLMs, RPA-PWM channels this through positional logic — it only awards UP bonuses *upstream of -35*, not anywhere in the sequence. This is reflected in its high SCR (0.920 vs gLMs ~0.46): RPA-PWM correctly distinguishes structured from scrambled compensation, while gLMs cannot.

See `scripts/rpa_pwm.py` for implementation.

### PA-PWM Ablation Analysis

The PA-PWM ablations address the critique that "PA-PWM is tuned to win":

1. **PA-PWM-NoComp** (no compensation logic): Removing UP element and extended -10 scoring makes it impossible to distinguish D from E (CSS=0.000, all pairs tied). D and E have identical -35 (TTGACA) and -10 (TGTAAT), differing only in compensatory elements. This confirms the compensation-specific logic is necessary — general positional encoding of core elements is not enough.

2. **PA-PWM-NoPos** (no positional encoding): Scanning for motifs anywhere produces CSS=0.630 with SCR=0.560 — nearly identical to HyenaDNA (CSS=0.630, SCR=0.480). Without positional constraints, even a model with explicit compensation logic performs only at the gLM level.

### Key Findings

1. **PA-PWM achieves CSS=1.000** vs HyenaDNA's 0.630 — explicit compensation logic at correct positions perfectly detects compensation
2. **RPA-PWM also achieves CSS=1.000 and SCR=0.920** — using only relative constraints (no hardcoded positions), addressing the circularity critique
3. **PA-PWM has SCR=0.980** — strongly distinguishes structured from scrambled motifs (vs HyenaDNA at 0.480)
4. **Removing compensation logic drops CSS to 0.000** — without UP/ext-10 scoring, D and E are indistinguishable
5. **Removing positional encoding drops CSS to 0.630 and SCR to 0.560** — matches HyenaDNA, confirming that positional constraints are what separates biophysical from gLM performance

### Interpretation

This comparison demonstrates that:
1. The mechanistic tests ARE solvable with explicit biological knowledge
2. **Even relative biological constraints suffice** — RPA-PWM achieves CSS=1.000 without knowing benchmark-specific absolute positions, using only spacing, upstream/downstream relationships, and strand consistency
3. The tested gLMs have not learned equivalent mechanistic principles
4. Both compensation logic AND positional encoding are needed — removing either one makes the model perform at or below gLM level
5. ~100 parameters of explicit biological knowledge (PWM weights, positions, spacing rules) outperform gLMs with orders of magnitude more parameters on these mechanistic tests

---

## Critique-Addressing Experiments

The following experiments were added to address specific reviewer critiques of the initial results.

### Dinucleotide Frequency Control

**Critique addressed**: "Only controlled for AT content — maybe the effect is dinucleotide patterns."

We generated sequences with matched compositions to distinguish mononucleotide (AT%) from dinucleotide from positional effects:

| Condition | AT% | AA freq | AT freq | TA freq |
|-----------|-----|---------|---------|---------|
| Compensated | 0.599 | 0.123 | 0.078 | 0.072 |
| Match-AT | 0.622 | 0.089 | 0.098 | 0.090 |
| Match-Dinuc | 0.613 | 0.121 | 0.085 | 0.073 |
| Broken | 0.578 | 0.077 | 0.087 | 0.077 |

**PA-PWM validation** (biophysical ground truth, position-aligned):

| Comparison | P(X > Y) | Interpretation |
|------------|----------|----------------|
| P(Compensated > Broken) | **1.000** | Compensation perfectly detected |
| P(Match-AT > Broken) | 0.530 | AT alone ≈ random |
| P(Match-Dinuc > Broken) | 0.710 | Dinucs provide partial signal |
| P(Compensated > Match-AT) | **1.000** | Position matters beyond AT% |
| P(Compensated > Match-Dinuc) | **0.980** | Position matters beyond dinucs |

**Key finding**: The position-aligned biophysical model perfectly distinguishes real compensated sequences from all composition-matched controls. Match-AT sequences (same AT% but random arrangement) score near chance against broken, while real compensated sequences with motifs at correct positions score higher 100% of the time. This confirms the CSS signal in biophysical models is positional, not compositional. gLM inference on these sequences would test whether gLMs can make the same distinction.

See `scripts/experiment_dinucleotide_control.py` for full implementation.

### Error Analysis

**Critique addressed**: "No analysis of which sequences models get right vs wrong."

We analyzed which D/E pairs each model classifies correctly (compensated > broken) vs incorrectly.

**HyenaDNA** (CSS=0.630, 63 correct, 37 incorrect):

| Property | Correct pairs | Incorrect pairs | p-value |
|----------|--------------|-----------------|---------|
| AT% difference (E - D) | +0.035 | -0.026 | **1.0e-6 *** |
| AT% of compensated seq | 0.617 | 0.583 | **4.0e-4 *** |
| AT% of broken seq | 0.582 | 0.609 | **0.005 ** |
| Max AT run (compensated) | 8.83 | 7.76 | **0.014 * ** |
| Upstream AT% (compensated) | 0.639 | 0.597 | **0.022 * ** |

HyenaDNA succeeds when the compensated sequence has higher AT% than the broken sequence, and fails when the broken sequence happens to have higher AT%. This confirms the AT-driven heuristic.

**GROVER** (CSS=0.520, 52 correct, 48 incorrect):
AT% difference is also significant (p=0.002), suggesting the same AT-driven mechanism at a weaker level.

**Cross-model agreement** (HyenaDNA vs GROVER): ~67% agreement rate. Models fail on partially overlapping but not identical sequence subsets, suggesting a shared compositional bias with model-specific noise.

See `scripts/experiment_error_analysis.py` for full results.

### MPRA Cross-Reference Validation

**Critique addressed**: "No experimental validation — compensated sequences assumed functional."

We generated a 500-sequence MPRA-like library with systematic variation of -35, -10, UP elements, extended -10, and spacing. The biophysical model (ThermodynamicModel) serves as a validated proxy for experimental expression:
- Estrem et al. 1998: UP elements provide 30-fold activation
- Ross et al. 1993: AT-rich upstream regions enhance transcription
- Hawley & McClure 1983: -10 mutations reduce activity >100-fold

The library is saved to `data/results/mpra_library.json` for gLM inference. The correlation between gLM scores and biophysical scores would provide a proxy for how well gLMs predict real expression.

See `scripts/experiment_mpra_validation.py` for implementation.

---

## Limitations

1. **Model coverage**: Results are from 5 gLMs (HyenaDNA, Evo2-1B, NT-500M, GROVER, Caduceus) plus baselines. DNABERT-2 remains to be tested. Evo2-1B uses autoregressive log-likelihood scoring; Caduceus and NT-500M use pseudo-log-likelihood (PLL) scoring. The addition of Evo2-1B (StripedHyena architecture) and Caduceus (bidirectional Mamba architecture) broadens coverage across autoregressive, masked, and SSM-based architectures.

2. **Single regulatory system**: All experiments use E. coli σ70 promoters. Eukaryotic enhancers, yeast promoters, or other bacterial sigma factors may show different patterns.

3. **No wet-lab validation**: We use published literature and biophysical models as proxies for experimental validation. Direct MPRA validation of our synthetic sequences would strengthen claims.

4. **Scoring method**: Evo2-1B uses autoregressive log-likelihood (sum of per-token log-probs). NT-500M and Caduceus use pseudo-log-likelihood (PLL) scoring. GROVER uses mean embedding values as proxy scores rather than true PLL, which may underestimate its capabilities.

5. **Claim scope**: Our conclusions apply to the specific models, promoter system, and mechanistic tests evaluated here. We do not claim these findings generalize to all gLMs or all regulatory contexts.

---

## Reproducibility

All experiments can be reproduced with a single command:

```bash
# Full experiment pipeline with logging (requires GPU)
conda activate nest
python scripts/run_all_experiments.py --gpu=1

# Or run individual stages:

# Generate sequences
python scripts/generate_sequences.py --output data/sequences/

# Run baselines only (no GPU required)
python scripts/run_all_experiments.py --skip-gpu

# Run biophysical comparison only
python scripts/run_biophysical_comparison.py

# Run RPA-PWM (fair baseline with relative constraints only)
python scripts/rpa_pwm.py

# Run critique-addressing experiments
python scripts/experiment_dinucleotide_control.py
python scripts/experiment_error_analysis.py
python scripts/experiment_negative_mes.py
python scripts/experiment_mpra_validation.py
```

### Environment

- Python 3.10 (conda environment: `nest`)
- PyTorch 2.6.0 with CUDA 12.4 support
- 4x NVIDIA A100 80GB PCIe
- Evo2-1B: separate venv (`venv_evo2`) with evo2, transformer-engine, flash-attn
- Caduceus: separate venv (`venv_caduceus`) with mamba_ssm 2.2.4, causal-conv1d 1.5.0.post8
- All logs saved to `logs/<timestamp>/experiment.log`
